(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ed59654a"],{1235:function(e,t,s){"use strict";s("5b03")},"5b03":function(e,t,s){},"7b8b":function(e,t,s){},"91a0":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"CoursesEnrolled"}},[t("div",{staticClass:"container",staticStyle:{"min-height":"150px"}},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-11"},[t("h1",[t("b-icon",{attrs:{icon:"people"}}),e._v(" Personas de "+e._s(e.desserts.name))],1)]),t("div",{staticClass:"col-1"},[t("h1",[t("b-icon",{attrs:{type:"button",icon:"arrow-return-left"},on:{click:e.toCourse}})],1)])])]),t("div",{staticClass:"card-body"},[t("b-row",[t("b-col",[t("EnrolledRegister",{attrs:{idCourse:e.id}})],1),t("b-col",{staticClass:"mb-3"},[t("b-input-group",{staticClass:"mb-2 mr-sm-2 mb-sm-0"},[t("b-input-group-prepend",{attrs:{"is-text":""}},[t("b-icon",{attrs:{icon:"search"}})],1),t("b-form-input",{attrs:{placeholder:"Buscar",type:"text"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1)],1)],1),0!=e.desserts.list.length?t("div",[t("b-table",{attrs:{striped:"",responsive:"",stacked:"lg",items:e.items,fields:e.fields,"per-page":e.perPage,"current-page":e.currentPage,keyword:e.keyword},scopedSlots:e._u([{key:"cell(names)",fn:function(s){return[t("p",[e._v(" "+e._s(s.item.lastnameFather+" "+s.item.lastnameMother+", "+s.item.name)+" ")])]}},{key:"cell(foulPercentage)",fn:function(s){return[null==s.item.foulPercentage?t("b",[e._v("-")]):s.item.foulPercentage>30?t("b",{staticClass:"text-danger"},[e._v(" "+e._s(s.item.foulPercentage+"%")+" ")]):t("b",{staticClass:"text-success"},[e._v(e._s(s.item.foulPercentage+"%"))])]}}],null,!1,3827837736)}),t("b-pagination",{staticStyle:{display:"flex","justify-content":"center"},attrs:{pills:"","total-rows":e.items.length,"per-page":e.perPage,"aria-controls":"my-table"},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),t("center",[t("b-button",{attrs:{variant:"primary"},on:{click:e.exportExcel}},[e._v("Reporte Asistencia")])],1)],1):t("div",[t("hr"),e._m(0)])],1)])])])},o=[function(){var e=this,t=e._self._c;return t("em",[t("p",{staticClass:"text-center"},[e._v("No hay datos en esta tabla")])])}],a=s("25ca"),n=s("3e8f"),i=s("d485"),l=s("3f13"),c=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"EnrolledRegister"}},[t("button",{staticClass:"btn mb-3",staticStyle:{"background-color":"#1d425e",color:"white"},on:{click:function(t){return e.addPerson()}}},[e._v(" Agregar persona ")]),t("div",[t("b-modal",{attrs:{scrollable:"",centered:"",title:"Registro de personal"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[t("div",{staticClass:"w-100"},[t("button",{staticClass:"btn form-control my-2",staticStyle:{"background-color":"#1d425e",border:"none",color:"white"},attrs:{type:"button"},on:{click:function(t){return e.addData()}}},[e._v(" Enviar ")]),t("button",{staticClass:"btn form-control",staticStyle:{"background-color":"rgb(119, 35, 45)",border:"none",color:"white"},attrs:{type:"button"},on:{click:function(t){return e.exit()}}},[e._v(" Cancelar ")])])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t("b-container",{attrs:{fluid:""}},[t("AlertError",{ref:"error"}),t("b-overlay",{attrs:{show:e.showOverlay,rounded:"sm"}},[t("b-form-group",{staticClass:"my-2",attrs:{label:"Buscar usuario:"}},[t("b-input-group",[null==e.selected?t("b-form-input",{attrs:{type:"text",placeholder:"Ingrese nombre"},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}}):t("b-form-input",{attrs:{type:"text",placeholder:"Ingrese nombre",disabled:"",value:e.selected.names}}),null!=e.selected?t("b-input-group-append",{on:{click:function(t){return e.deselect()}}},[t("b-form-checkbox",{attrs:{button:"","button-variant":"primary"}},[t("b-icon-x")],1)],1):t("b-input-group-append",[t("b-button",{on:{click:function(t){return e.inquiry()}}},[t("b-icon-search")],1)],1)],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:null==e.selected&&0!=e.options.length,expression:"selected == null && options.length != 0"}]},[t("b-form-select",{attrs:{options:e.options,"select-size":e.tamOptions(e.options.length)},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)],1),t("b-form-group",{staticClass:"my-2",attrs:{label:"Seleccionar rol:"}},[t("b-form-select",{attrs:{options:e.optionsRole},model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}})],1)],1)],1)],1)])},d=[],u=(s("14d9"),s("2df4")),h={name:"EnrolledRegister",components:{AlertError:u["a"]},props:{idCourse:{type:String,default:null}},data(){return{showOverlay:!1,show:!1,selected:null,selectedRole:null,text:"",options:[],optionsRole:[],addPersonData:{}}},created(){this.ListRoles()},methods:{tamOptions(e){return 1==e?2:e},async addData(){this.addPersonData.personId=this.selected.id,this.addPersonData.roleId=Number(this.selectedRole),await this.$axios.post("/academic/course/"+this.idCourse+"/enrolled-register",this.addPersonData,{headers:{Authorization:"Bearer "+localStorage.token}}).then(e=>{this.show=!1,this.$message.success(e.data.content),this.$parent.initialize()}).catch(e=>{console.log(e),this.$refs.error.showAlert(e.response.data.content)})},async ListRoles(){await this.$axios.get("/academic/course/"+this.idCourse+"/enrolled-register",{headers:{Authorization:"Bearer "+localStorage.token}}).then(e=>{this.optionsRole=e.data}).catch(e=>{this.$errorQuery(e)})},async inquiry(){this.showOverlay=!0,this.options=[],this.inquiryValided()},async inquiryValided(){await this.$axios.get("/person/search?names="+this.text,{headers:{Authorization:"Bearer "+localStorage.token}}).then(e=>{for(let s=0;s<e.data.length;s++){var t={};t.text=e.data[s].names+" ("+e.data[s].email+")",t.value=e.data[s],this.options.push(t)}this.showOverlay=!1}).catch(e=>{this.$errorQuery(e)})},deselect(){this.options=[],this.selected=null,this.text=null},addPerson(){this.text="",this.selected=null,this.selectedRole=null,this.addPersonData={},this.show=!0,this.options=[]},exit(){this.show=!1}}},p=h,b=(s("1235"),s("2877")),m=Object(b["a"])(p,c,d,!1,null,null,null),g=m.exports;a["b"](n),a["c"].set_readable(i["Readable"]),a["a"](l);var f={name:"CoursesEnrolled",components:{EnrolledRegister:g},props:{id:{type:String,default:""}},data(){return{keyword:"",perPage:10,currentPage:1,desserts:{list:[]},fields:[{key:"number",label:"#"},{key:"names",label:"Apellidos, Nombres"},{key:"role",label:"Rol"},{key:"foulPercentage",label:"Inasistencia",sortable:!0},{key:"phone",label:"Celular"}]}},created(){this.initialize()},computed:{rows(){return this.desserts.list.length},items(){return this.currentPage=1,this.keyword?this.desserts.list.filter(e=>e.name.toLowerCase().includes(this.keyword.toLowerCase())||e.lastnameFather.toLowerCase().includes(this.keyword.toLowerCase())||e.lastnameMother.toLowerCase().includes(this.keyword.toLowerCase())||e.role.toLowerCase().includes(this.keyword.toLowerCase())):this.desserts.list}},methods:{toCourse(){this.$router.go(-1)},exportExcel(){var e=this.desserts.list;for(let o=0;o<e.length;o++)delete e[o].id,delete e[o].number;let t=a["d"].json_to_sheet(e);t["A1"].v="NOMBRES",t["B1"].v="AP. PATERNO",t["C1"].v="AP. MATERNO",t["D1"].v="ROL",t["E1"].v="INASISTENCIA(%)",t["F1"].v="CELULAR";const s=a["d"].book_new(),r="asistencia";a["d"].book_append_sheet(s,t,r),a["e"](s,this.desserts.name+"_ReporteExcel.xlsx")},async initialize(){await this.$axios.get("/academic/course/"+this.id+"/enrolled",{headers:{Authorization:"Bearer "+localStorage.token}}).then(e=>{this.desserts=e.data;for(let t=0;t<this.desserts.list.length;t++)this.desserts.list[t].number=t+1}).catch(e=>{this.$errorQuery(e)})}}},y=f,v=(s("9834"),Object(b["a"])(y,r,o,!1,null,null,null));t["default"]=v.exports},9834:function(e,t,s){"use strict";s("7b8b")}}]);
//# sourceMappingURL=chunk-ed59654a.0a9df4ee.js.map